# SuiWorld 프로젝트 아키텍처 및 용어 정리

이 문서는 SuiWorld 프로젝트의 전체적인 기술 스택, 아키텍처, 주요 파일의 역할, 그리고 핵심 용어에 대해 설명합니다. 새로운 팀원이 프로젝트를 빠르게 이해하고 기여할 수 있도록 돕는 것을 목표로 합니다.

## 1. 전체 아키텍처

SuiWorld는 Sui 블록체인 위에서 동작하는 탈중앙화 애플리케이션(dApp)으로, 크게 4가지 주요 부분으로 구성됩니다.

- **Frontend (Next.js)**: 사용자가 직접 상호작용하는 웹 인터페이스입니다. React 기반의 Next.js 프레임워크와 TypeScript를 사용하여 구축되었습니다.
- **Backend (FastAPI)**: 프론트엔드와 블록체인 사이를 중계하고, 데이터베이스 관리, 사용자 인증 등 오프체인 로직을 처리하는 API 서버입니다. Python 기반의 FastAPI 프레임워크를 사용합니다.
- **Smart Contracts (Sui Move)**: 프로젝트의 핵심 온체인 로직을 담고 있는 스마트 계약입니다. Sui 블록체인의 네이티브 언어인 Move로 작성되었습니다.
- **Scripts & Config**: 개발 환경 설정, 데이터베이스 시딩, 배포 등을 위한 스크립트 및 설정 파일들입니다.

```
[ User ]
    |
    v
[ Frontend (Next.js) ] <--> [ Backend (FastAPI) ] <--> [ Database (PostgreSQL) ]
    |                                |
    |                                v
    +----------------------> [ Sui Blockchain (Move Smart Contracts) ]
```

## 2. 주요 디렉토리 및 파일 역할

### 📂 `frontend`
Next.js와 TypeScript로 구축된 웹 애플리케이션입니다.

- **`app/`**: Next.js의 App Router 구조입니다.
  - `page.tsx`: 메인 랜딩 페이지입니다.
  - `gallery/[slug]/page.tsx`: 특정 갤러리 상세 페이지입니다.
  - `message/[id]/page.tsx`: 특정 메시지 상세 페이지입니다.
- **`hooks/usecases/`**: 각 기능별 비즈니스 로직을 담고 있는 커스텀 훅입니다. 백엔드 API를 호출하고 상태를 관리합니다.
  - `auth.usecase.ts`: 인증 관련 로직
  - `galleries.usecase.ts`: 갤러리 관련 로직
- **`lib/`**: 공통 유틸리티 및 라이브러리 설정 파일입니다.
  - `fetcher.ts`: API 요청을 위한 `fetch` 래퍼 함수입니다.
  - `sui/provider.ts`: Sui 블록체인과 상호작용하기 위한 클라이언트 설정입니다.
- **`types/api.ts`**: 백엔드 API와 주고받는 데이터의 TypeScript 타입 정의입니다.

### 📂 `backend`
Python과 FastAPI로 구축된 API 서버입니다.

- **`app/`**: FastAPI 애플리케이션의 핵심 소스 코드입니다.
  - `main.py`: FastAPI 애플리케이션의 메인 진입점. 미들웨어, 라우터 설정 등을 포함합니다.
  - `db.py`: 데이터베이스 세션 및 연결을 관리합니다.
  - `models.py`: SQLAlchemy 모델 (데이터베이스 테이블 스키마) 정의입니다.
  - `schemas.py`: Pydantic 스키마 (API 데이터 유효성 검사 및 직렬화) 정의입니다.
  - `security.py`: 비밀번호 해싱, JWT 토큰 생성/검증 등 보안 관련 기능을 담당합니다.
  - `chain.py`: Sui 블록체인과의 상호작용(트랜잭션 전송 등)을 처리하는 모듈입니다.
  - **`api/`**: 기능별 API 엔드포인트(라우터)를 정의합니다.
    - `auth.py`: 회원가입, 로그인 등 인증 API
    - `proposals.py`: 제안/투표/결과(하이프/스캠) 라우터입니다. 좋아요/알럿 임계값 도달로 생성된 제안을 관리하고, 매니저의 투표를 처리하며, 결과에 따른 보상/슬래싱 트랜잭션을 집행하는 API를 제공합니다.
- **`tests/`**: 백엔드 API 테스트 코드입니다.

### 📂 `move`
Sui 블록체인 위에서 실행되는 스마트 계약의 소스 코드입니다.

- **`Move.toml`**: Move 패키지의 설정 파일입니다. 패키지 정보, 의존성 등을 정의합니다.
- **`sources/`**: 스마트 계약 소스 파일(.move)이 위치합니다.
  - `gallery.move`: 갤러리 생성 및 관리에 대한 온체인 로직입니다.
  - `swap.move`: 자산(토큰, NFT 등) 교환에 대한 온체인 로직입니다.
  - `vote.move`: 제안에 대한 투표 로직입니다.
  - `token.move`: 프로젝트에서 사용되는 커스텀 토큰 관련 로직입니다.

### 📂 `scripts`
개발 및 배포를 위한 보조 스크립트입니다.

- `devnet-init.sh`: 개발넷에 스마트 계약을 배포하고 초기화하는 쉘 스크립트입니다.
- `env.sample`: 프로젝트에 필요한 환경 변수 샘플 파일입니다.
- `seed.sql`: 개발용 초기 데이터를 데이터베이스에 삽입하는 SQL 파일입니다.

## 3. 핵심 용어 정리

### Proposal (제안)
- **정의**: 특정 콘텐츠(예: 갤러리)가 커뮤니티로부터 많은 '좋아요'를 받아 **'하이프(Hype)'** 제안이 되거나, 많은 '신고(Alert)'를 받아 **'스캠(Scam)'** 제안이 되는 등, 특정 임계값 도달 시 자동으로 생성되는 검증 안건입니다. 이 제안은 해당 콘텐츠가 보상(Reward)을 받을 가치가 있는지, 아니면 페널티(Slashing)를 받아야 하는지를 매니저들의 투표로 결정하기 위해 사용됩니다.
- **특징**: 백엔드는 온체인 투표/결과 이벤트를 수신하거나, 트랜잭션의 반환값을 직접 저장하여 데이터베이스의 제안 상태를 최신으로 유지합니다.

### Proposal의 상태 (Lifecycle)
제안은 생성부터 완료까지 다음과 같은 상태를 거칩니다.

1.  **Open (개설)**
    - **설명**: 특정 콘텐츠가 '좋아요' 또는 '신고' 임계값을 충족하면 해당 콘텐츠에 대한 제안이 자동으로 생성되고 'Open' 상태가 됩니다. 이 단계에서 백엔드(`proposals.py`)는 이 제안 엔티티를 데이터베이스에서 관리하기 시작합니다.

2.  **Vote (투표 진행)**
    - **설명**: 'Open'된 제안에 대해 **매니저(Manager NFT 보유자)**들이 투표하는 단계입니다. 매니저들은 프론트엔드를 통해 자신의 지갑으로 트랜잭션에 서명하고, 이는 `vote.move` 스마트 계약의 투표 함수를 호출합니다. 백엔드는 이 과정을 중계하거나 온체인 이벤트를 통해 투표 상황을 감지합니다.

3.  **Resolve (결정/해결)**
    - **설명**: 투표가 종료되고 결과를 확정하는 최종 상태입니다.
    - **통과 조건**: 총 3명의 매니저 중 2명 이상이 찬성하면 제안이 '통과'됩니다.
    - **결과 집행**:
        - **'Hype' 제안 통과 시**: 콘텐츠 생성자에게 **보상(Reward)**을 지급하는 트랜잭션이 실행됩니다.
        - **'Scam' 제안 통과 시**: 콘텐츠 생성자에게 **슬래싱(Slashing)** 페널티를 부과하는 트랜잭션이 실행됩니다.
    - **부결 시**: 제안은 아무런 효력 없이 종료됩니다.